<!DOCTYPE html>
{% load static %}
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Quizzes</title>
    <link rel="stylesheet" href="{% static 'Home/styleano.css' %}">
</head>
<body>

    <!-- Cabeçalho -->
    <header class="header">
        <h1>EducaSite</h1>
    </header>

    <!-- Navegação -->
    <nav class="navbar">
        <a href="/Home">Início</a>
        <a href="/Home/matematica">Matemática</a>
        <a href="/Home/portugues">Português</a>
        <a href="/Home/geografia">Geografia</a>
        <a href="/Home/historia">História</a>
    </nav>

    <!-- Caixa de Texto de Introdução -->
    <div class="container">
        <section class="main-content">
            <h2>6° Ano</h2>
            
        </section>
    </div>
      
    <!-- Seção de Quizzes -->
    <div id="app">
        <div class="container mt-5 pt-5">
            <div class="col-mod-6 mx-auto">
                <h3>Give quiz</h3>
                <div v-for="(question, index) in questions" :key="index">
                    <hr>
                    <p>[[ question.question ]]</p>  <!-- Exibe a pergunta -->
                    <div v-if="question.answers.length > 0" v-for="(answer, index) in question.answers" :key="index" class="form-check">
                      <input @change="checkAnswer($event, question.uid)" :value="answer.answer" class="form-check-input" type="radio" :name="'question-' + question.id" :id="'answer-' + index">
                      <label class="form-check-label" :for="'answer-' + index">
                        [[ answer.answer ]]
                      </label>

                    </div>
                    <p v-else>Não há opções de resposta para esta questão.</p>  <!-- Mensagem para questões sem respostas -->
                    <hr>
                  </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>

    <script>
        var app = new Vue ({
        el: '#app',
        delimiters: ['[[', ']]'],
        data() {
          return {
            category: "Português6",
            questions : []
          }
        },
        methods :{
            getQuestions() {
                if (!this.category) {
                    alert("Escolha uma categoria!");
                    return;
                }

                fetch(`/Home/api/get-quiz/?category=${encodeURIComponent(this.category)}`)
                    .then(response => response.json())
                    .then(result => {
                    console.log("Resultado do quiz:", result);  // Exibe o resultado da API no console
                    if (result && result.data) {
                        this.questions = result.data;  // Atualiza as questões
                        console.log("Questões:", this.questions);  // Verifique se 'questions' está sendo atualizado corretamente
                    } else {
                        console.error("Erro: Dados não encontrados na resposta da API.");
                    }
                    })

                    .catch(error => {
                    console.error("Erro no fetch:", error);
                    });
                },
                checkAnswer(event, uid) {

                    const question = this.questions.find(q => q.uid === uid);

                    if (question) {
               
                        question.answers.forEach(answer => {
                       
                            if (answer.answer === event.target.value) {
                                if (answer.is_correct) {
                                    console.log('Your answer is correct');
                                    alert("Sua resposta está correta!");
                                } else {
                                    console.log('Your answer is wrong');
                                    alert("Sua resposta está errada!");
                                }
                            }
                        });
                    }
                    console.log(event.target.value, uid); 
                }

        },


        created() {
          this.getQuestions()
          console.log('Page Loaded')
        },
      });
    </script>

    <!-- Rodapé -->
    <footer class="footer">
        <p>&copy; 2025 EducaSite. Todos os direitos reservados.</p>
    </footer>

</body>
</html>